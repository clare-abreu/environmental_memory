This folder contains the code used in Abreu et al (Nature Ecology & Evolution, 2024).

The subfolder infer_fitness contains code for inferring fitness of mutants based on raw frequency data, and formatting these fitness inferences for plotting in the figures.

The files included here are:

# figure2.py:
This figure plots: A) non-additivity in three fluctuating environments, B-D) a few individual barcoded mutant trajectories (averaged across replicate fitness measurements) against the expected trajectories based on static environment fitness, E) all values of non-additivity across all mutants in all fluctuating environments, F) all values of environmental memory, G-H) non-additivity and memory significance scores.

# figure3.py:
This figure plots fitness in three fluctuating environments and their corresponding static environment components. The first row shows fitness across the pairs of static environments, where mutants are colored more red or more blue if they have higher fitness in either of the two environments. In the second row, this color scheme is preserved, but the plots show how the mutants' fitness changes from the static environment to the corresponding component of the fluctuating environment. For example, the left plot in the second row shows fitness in the galactose component in the fluctuating environment minus fitness in static galactose. These plots show that darker blue/red points tend to be farther from the origin, meaning mutants that have bigger differences in fitness across the static environments have more memory. The third row shows that this trend is even more noticeable when the mutants are colored not just by their difference in fitness across one pair of environments, but by their mean fitness difference across all ten pairs.

# figure4.py:
This figure plots overall fitness statistics. In panel A, the mean memory and mean non-additivity across fluctuating environments correlates with the mean fitness difference across pairs of static environments. In panel B, we show how often fitness reversals happen, with a bar plot of the relative frequencies of when the same static environment is a better predictor of fitness in a fluctuating environment (e.g. how often is static Glu fitness a better predictor than static Gal fitness for the fitness in the Glu component of Glu/Gal?), vs the other static environment being a better predictor. Panel C shows two controls: first, we predict fitness in replicates of static environments with either other replicates of the same environment or replicates of another environment; second, we predict fitness in one replicate of a fluctuating environment component (which contains half as many timepoints as static environments and thus should be twice as noisy) with other replicates of that same component or the other component.

In the second row, we plot statistics generated by a simple mathematical model (see Methods and SI for details of the model). In the model, a mutant has a difference in fitness relative to the ancestor because it has a difference in lag phase. Mutants with bigger mean fitness differences across pairs of static environments have wider ranges of lag (dis)advantages compared to the ancestor across environments. In a fluctuating environment, we assume that a mutant's lag (dis)advantage shifts from the value in the given environment toward the mean across all environments, by a factor set to 0.8 (or 80 percent of the distance toward the mean). This assumption recapitulates the pattern seen in the data.

# figure5.py:
This figure integrates genomic information into the overall memory statistics. This data, stored in ../data/WGS/, contains information about 1) homozygous and heterozygous SNPs identified in our mutants, 2) ploidy information as interpreted from a benomyl plating test, and 3) copy-number amplification as identified from comparing coverage across the genome.

# angle_origin_distance.py:
In this R notebook, we ask whether fitness difference is the correct metric to correlate with non-additivity and memory. As shown in Supp. Fig. 10, fitness difference is proportional to r*sin(theta), where r is distance from the origin in a two-environment fitness plot, and theta is the angle from the equal-fitness line. If both r and sin(theta) do not independently contribute to 